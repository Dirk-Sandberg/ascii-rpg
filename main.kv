#:import TextLog text_log.TextLog
#:import NoTransition kivy.uix.screenmanager.NoTransition
#:include inventory.kv

ScreenManager:
    Screen:
        name: 'home_screen'
        BoxLayout:
            orientation: 'vertical'
            # Main game UI
            id: main_ui
            size_hint: 1, 1
            Label:
                id: toolbar
                size_hint: 1, .1
                text: "Health: " + str(app.player.current_health) + '/' + str(app.player.max_health) + " Floor: " + str(app.floor) + " Base Damage: " + str(app.player.attack) + " Base Defense: " + str(app.player.defense)
                canvas.before:
                    Color:
                        rgba: (1-app.player.current_health/app.player.max_health),app.player.current_health/app.player.max_health,0,1
                    Rectangle:
                        size: self.width * (app.player.current_health/app.player.max_health), self.height
                        pos: self.pos
            BoxLayout:
                # Maybe make this a screenmanager and toggle between ATK vs SPELL vs NON-ATK phase
                size_hint: 1, .7
                orientation: 'vertical'
                Label:
                    id: combat
                    markup: True
                Label:
                    id: monster_toolbar
                    size_hint: 1, .1
                TextLog:
                    id: log
                    markup: True
                    text_size: self.size
                    size_hint: 1, .2
                GridLayout:
                    size_hint: 1, .1
                    rows: 1
                    Button:
                        text: "ATTACK"
                        on_release:
                            app.attack()
                        disabled: app.is_home
                    Button:
                        text: "MAGIC"
                        on_release: app.cast_spell()
                        disabled: app.is_home
                    Widget:
                    Widget:
                    Button:
                        text: "EMBARK"
                        on_release:
                            app.embark()
                        disabled: not app.is_home
                    Button:
                        text: "BAG"
                        on_release:
                            root.current = 'inventory_screen'
                        disabled: not app.is_home

    InventoryScreen:
        name: 'inventory_screen'
        id: inventory
